@page "/event/{eventId:int}/pilot/{pilotId:int}"
@rendermode InteractiveWebAssembly
@inject HttpClient Http
@inject NavigationManager NavigationManager
@using FPVPulse.LocalHost.Client.Components.Data
@using Newtonsoft.Json
@inject IJSRuntime JS
<h3>Event Pilot View</h3>

@if (pilot != null)
{
		<code>@JsonConvert.SerializeObject(pilot, Formatting.Indented)</code>
}
else
{
		<p>Loading ...</p>
}

@code {
    [Parameter]
    public int eventId { get; set; }
    [Parameter]
	public int pilotId { get; set; }

	Pilot pilot;

	protected override async Task OnAfterRenderAsync(bool firstRender)
	{
		if (firstRender && OperatingSystem.IsBrowser())
			await LoadRaceAsync();
	}

	private async Task LoadRaceAsync()
	{
		pilot = await Http.GetFromJsonAsync<Pilot>($"api/pilot/{pilotId}");
		StateHasChanged();
	}
}
